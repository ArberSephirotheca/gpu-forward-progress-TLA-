#version 450
#extension GL_KHR_shader_subgroup_basic : enable
layout(local_size_x = 256) in;


layout(std430, binding = 0) buffer Lock {
    uint lock;
};

void main() {
    lock = 0;
    uint old = 1;
    do {
        old = atomicExchange(lock, 1);
    } while (old != 0);
    
    lock = 0;
}